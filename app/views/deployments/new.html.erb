<head>
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<%= stylesheet_link_tag 'deployment-page'%>
<link href='https://fonts.googleapis.com/css?family=Titillium+Web:400,200,300,600,700' rel='stylesheet' type='text/css'>
</head>

<body>

<div id="menu-nav">

  <div id="navigation-bar">
    <ul>
      <li><a href="<%=user_projects_path(:user_id => @user.id)%>" style="color: #009944;">Projects</a>
      </li>
      <li><a href="/users/<%=@user.id%>/projects/<%=@project_id%>/commits" style="color: #009944;"><span>Commits</span></a>
      </li>
      <li><a><span style="color: #00FF00;">Checklist</span></a>
      </li>
      <li><a><span>Approval</span></a>
      </li>
      <li><a><span>Deploy</span></a>
      </li>
    </ul>
    <ul class="timeline" id="timeline">
      <li class="li complete">
        <div class="status">
          <h4> Project Selected </h4>
        </div>
      </li>
      <li class="li complete">
        <div class="status">
          <h4> Commit Selected </h4>
        </div>
      </li>
      <li class="li">
        <div class="status">
          <h4> Checklist Filled </h4>
        </div>
      </li>
      <li class="li">
        <div class="status">
          <h4> Deploy Approved </h4>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="fixed-username" >
  Hello, <%= @user.name %>
</div>
<div class="fixed-logout" >
  <% if user_signed_in? %>
    <%= link_to('Logout', destroy_user_session_path, method: :delete) %>
  <% end %>
</div>
<br>

<div class="container" style="color: black;">
<%= form_for :deployments, url: "/deployments" do |form| %>

  <label >TITLE:</label>
  <%= form.text_field :title ,class: 'form-group form-control', required: true , placeholder: "Project Name"%>

  <label >OVERVIEW:</label>
  <%= form.text_area :overview ,class: 'form-group form-control', required: true, placeholder: "Describe your deployment" %>

  <label >COMMITTERS:</label>
  <%= form.text_area :committers ,class: 'form-group form-control',required: true, placeholder: "Mention Committers" %>
  <hr>

  <h5 style="color: #4DA852;"><b>SERVICES IMPACTED</b></h5>
  <%= form.text_area :service_impacted ,class: 'form-group form-control' %>
  <hr>

  <h5 style="color: #4DA852;"><b>Service Details</b></h5>
  <label >1. Please provide URL for your wiki page for this specific change:</label>
  <%= form.text_field :service_details_1 ,class: 'form-group form-control', required: true, pattern: "https:\/\/source.golabs.io\/.+\/.+\/wikis/.+",  placeholder: "https://source.golabs.io/your_username/project_name/wikis/xxxx" %>
  <label >2. Please provide datadog dashboard URL for your service:</label>
  <%= form.text_field :service_details_2 ,class: 'form-group form-control', required: true, pattern: "https:\/\/app.datadoghq.com\/.+", placeholder: "https://app.datadoghq.com/xxxx" %>
  <label >3. Please provide newrelic dashboard URL for your service:</label>
  <%= form.text_field :service_details_3 ,class: 'form-group form-control', required: true, pattern: "https:\/\/rpm.newrelic.com\/accounts\/[1-9]+\/applications/[1-9]+", placeholder: "https://rpm.newrelic.com/accounts/xxxxxxx/applications/xxxxxxxx"%>
  <hr>

  <h5 style="color: #4DA852;"><b>Service Rollback</b></h5>
  <label >1. What’s your rollback strategy:</label>
  <%= form.text_area :service_rollback_1 ,class: 'form-group form-control' %>
  <label >2. Do you switch rollback with feature flag or does it require complete deployment again?</label>
  <%= form.text_field :service_rollback_2 ,class: 'form-group form-control' %><hr>

  <h5 style="color: #4DA852;"><b>Service Component - Database</b></h5>
  <%= form.text_field :service_component_database ,class: 'form-group form-control' %><hr>

  <h5 style="color: #4DA852;"><b>Service Component - Security</b></h5>
  <%= form.text_field :service_component_security ,class: 'form-group form-control' %><hr>

  <h5 style="color: #4DA852;"><b>Service Component - Monitoring</b></h5>
  <label >List all the services you own and list down each server monitoring parameters</label>
  <%= form.text_area :service_component_monitoring ,class: 'form-group form-control' %><hr>

  <h5 style="color: #4DA852;"><b>Service Component - Cache</b></h5>
  <%= form.text_field :service_component_cache ,class: 'form-group form-control' %><hr>

  <h5 style="color: #4DA852;"><b>Service Component - API Changes</b></h5>
  <%= form.text_field :service_component_api_changes ,class: 'form-group form-control' %>
  <label >1. Did you change API contract?</label>
  <%= form.text_field :service_component_api_changes_1 ,class: 'form-group form-control' %>
  <label >2. Is there versioned API for new version?</label>
  <%= form.text_field :service_component_api_changes_2 ,class: 'form-group form-control' %>
  <label >3. How are you ensuring backward compatibility</label>
  <%= form.text_area :service_component_api_changes_3 ,class: 'form-group form-control' %>
  <label >4. Is there is feature flag for this API to switch on and switch off?</label>
  <%= form.text_field :service_component_api_changes_4 ,class: 'form-group form-control' %>
  <label >5. What kind of API is this - does it make changes to database? Please provide API endpoint, protocol (http, grpc) and signature affected data contract.</label>
  <%= form.text_area :service_component_api_changes_5 ,class: 'form-group form-control' %><hr>

  <h5 style="color: #4DA852;"><b>Service Component - Analytics Impact</b></h5>
  <label >1. Does your change impact BI, if yes, please explain how? And get a approval from Crystal.</label>
  <%= form.text_area :service_component_analytics_impact_1 ,class: 'form-group form-control' %><hr>

  <h5 style="color: #4DA852;"><b>Service Component - Consumer App Impact</b></h5>
  <label >1. Does your change impact mobile consumer app? If yes, how does it impact</label>
  <%= form.text_area :service_component_consumer_app_impact_1 ,class: 'form-group form-control' %>
  <label >2. What components does it impact on Consumer App</label>
  <%= form.text_area :service_component_consumer_app_impact_2 ,class: 'form-group form-control' %>
  <label >3.Are these features toggled for specific consumers or all of them?</label>
  <%= form.text_field :service_component_consumer_app_impact_3 ,class: 'form-group form-control' %>
  <label >4. How will you ensure staggered roll out</label>
  <%= form.text_area :service_component_consumer_app_impact_4 ,class: 'form-group form-control' %>
  <label >5. Is there mixpanel configuration or play store configuration?</label>
  <%= form.text_field :service_component_consumer_app_impact_5 ,class: 'form-group form-control' %><hr>

  <h5 style="color: #4DA852;"><b>Service Component - Driver App Impact</b></h5>
  <%= form.text_area :service_component_driver_app_impact ,class: 'form-group form-control' %><hr>

  <h5 style="color: #4DA852;"><b>Service Component - GoResto App Impact</b></h5>
  <%= form.text_area :service_component_goresto_app_impact ,class: 'form-group form-control' %><hr>

  <h5 style="color: #4DA852;"><b>Service Component - Configuration Management Impact</b></h5>
  <%= form.text_area :service_component_configuration_management_impact ,class: 'form-group form-control' %><hr>

  <h5 style="color: #4DA852;"><b>Service Component - System Configurations</b></h5>
  <label >1. Did you check limits</label>
  <%= form.text_field :service_component_system_configurations_1 ,class: 'form-group form-control' %>
  <label >2. Did you check proxy update</label>
  <%= form.text_field :service_component_system_configurations_2 ,class: 'form-group form-control' %>
  <label >3. Does it require rollover deployment</label>
  <%= form.text_field :service_component_system_configurations_3 ,class: 'form-group form-control' %>
  <label >4. Does your code deployment requires full chef run on box</label>
  <%= form.text_field :service_component_system_configurations_4 ,class: 'form-group form-control' %>
  <label >5. How many boxes does this service deploy affect, list each of them.</label>
  <%= form.text_area :service_component_system_configurations_5 ,class: 'form-group form-control' %>
  <label >6. Do you have read and write clusters, please explain order of deployment</label>
  <%= form.text_area :service_component_system_configurations_6 ,class: 'form-group form-control' %>
  <label >7. Does your service implements circuit breaker? If yes, what’s the configuration?</label>
  <%= form.text_area :service_component_system_configurations_7 ,class: 'form-group form-control' %>
  <label >8. What’s the connection timeout configuration?</label>
  <%= form.text_area :service_component_system_configurations_8 ,class: 'form-group form-control' %>
  <label >9.What errors you would return if there are timeouts or internal errors?</label>
  <%= form.text_area :service_component_system_configurations_9 ,class: 'form-group form-control' %><hr>

  <h5 style="color: #4DA852;"><b>Project component - Code</b></h5>
  <label >1. List down commits with acceptance criteria, if it’s adhoc, mention adhoc, if it’s adhoc thenget sign off from tech lead and product manager, ask them to document this ad-hoc storyand put a proper sign off</label>
  <%= form.text_area :project_component_code_1 ,class: 'form-group form-control' %>
  <label >2. What kind of tests you have written for which acceptance criteria</label>
  <%= form.text_area :project_component_code_2 ,class: 'form-group form-control' %>
  <label >3. Does your code deals with concurrency?</label>
  <%= form.text_field :project_component_code_3 ,class: 'form-group form-control' %>
  <label >4 .Are you from reading or writing to files</label>
  <%= form.text_field :project_component_code_4 ,class: 'form-group form-control' %>
  <label >5. Are you reading or writing to same fields?</label>
  <%= form.text_field :project_component_code_5 ,class: 'form-group form-control' %>
  <label >6. How many domain entities are impacted?</label>
  <%= form.text_field :project_component_code_6 ,class: 'form-group form-control' %>
  <label >7. Do you read from database? If yes, then explain why do you need to read from database?And why don’t you use cache, also, how many places you utilise cache.</label>
  <%= form.text_area :project_component_code_7 ,class: 'form-group form-control' %>
  <label >8. How many synchronous calls your code makes? (Also list down in impacted services)</label>
  <%= form.text_area :project_component_code_8 ,class: 'form-group form-control' %><hr>

  <label >Choose a reviewer to mail</label>
  <br>
  <%=form.select :reviewer_email, User.all.collect { |x| x.email }, {:include_blank => "Select One"} %>
  <br>
  <br>
  <hr>
  <%= hidden_field_tag 'user_id', @deployment.user_id  %>
  <%= hidden_field_tag 'project_name', @deployment.project_name  %>
  <%= hidden_field_tag 'project_id', @project_id %>
  <%= hidden_field_tag 'commit_id', @deployment.commit_id  %>
  <%= hidden_field_tag 'last_deployed_commit', @last_deployed_commit  %>
  <%= form.submit  class: 'btn btn-primary'%>
  <%end %>
</div>
</body>

</html>
